# [Queens AI](https://rc-dynamics.github.io/queens_AI/)
> The [n Queens Puzzle](https://en.wikipedia.org/wiki/Eight_queens_puzzle) resolved with genetic algorithms.

> [Check out our application using Genetic Algoritmh on a web site](https://rc-dynamics.github.io/queens_AI/)


![](figs/queens.png)

## n Queens Puzzle
These application resolve the *queens puzzle* to different **board sizes** (8x8, 16x16, 32x32 and 64x64). Remember that the *queens puzzle* is a exponential problem.



## Genetic Algorithm Solution

### Genotype Representation

Using a vector of strings of bits, we have the following representation:

![](figs/genotype.png)
<div style="text-align: justify">  
Each gene represents the queen line, that is initialized differently for each queen, and the position of the gene on the genotype refers to the column on the board. 
Every genotype refers to a possible solution (configuration of the table), and to reach a correct solution tha genetic algorithm (G.A.) have to change the genes positions on the genotype,this change the queen of the line x, to another column.

###  Population
Population represents all genotypes of the algorithm. Random genotypes are responsible for filling the population in the **initilization** part, besides the genotype indiviuals also has its fitness.
**population size** stars in 100 by default, but may be configured by the UI.

###  Fitness Function
Fitness determine how well is a solution given a genotype. So all solutions in the population has your own fitness. A bad solution is mensured proportionally by the number of collisions.

To determine the queens collisions, each queen counts how many queens are on her's right diagonals. And the sum of each queen collition number is the *error* of a genotype. 

There are three different **fitness functions** implemented:
>1. Exponential:   1 / (1 + *error);
>2. Parabolic:  (x-max_error)^2 / max_error^2; 
>2. Linear:  -(*error*/max_error) + 1;

These are the graphics for eachs **board size**:
![](figs/fitness_function.png)

###  Parent Selection
The first parent selection method is the **two best of five**; this approach consists in getting five randoms fathers in the population. After, the best two genotype (mensured by fitness) among the five are choosen to reproduce. 
Another method is **roulette wheel**, which every genotype has a chance to be selected proportional to its fitness.

###  Crossover
The crossover method were a **cut and crossfill**. A random position on the genotype is choosed, this position cut the genotype chain of both parents in two parts. Sons were generated by the crossfill of the parents parts on the cutted position. Two sons per couple were created.

A first son is made of the first part of parent one, and the sencond part of parent two.

**Number os couples** determines the number of crossover on the population. Each couple has two parentes and will generate two sons.

![](figs/crossover.png)

To maintain each queen on a different line, no duplicates genes were accepted on a genotype is permited. To obey this rule, if the second part of the second parent has duplicate genes on the first part of the first parent, the son iterate to another gene on the sencod parent, until there isn't a duplicate.

The **crossover rate** is the probabilty from 0 to 1.0 to reproduce two chosen parents.

Every iteration needs to calculate the children fitness to introduce them on the population.


###  Mutation
The G.A. **mutation method** implemented choose two random genes on the genotype and swap their positions. Considering that each genotype has queens for all possibles positions, there isn't new gene to be inserted.

Remember that the **mutation rate** configure the probability from 0 to 1.0 of mutating a son.

### Selection 

After generating sons the populion needs to maintain its size, so there are methos to select the final population after reproduction. 
First method is the **best fitness**, in this approach the population will be the bests genotypes, so sons replace  those with the lower fitness value for a child with high value.
Another way is **generational**, for that, after a father passes through the cross-over phase, his genotype will be replaced by the son. So the old one dies and and the news maintains on the population.

### Termination 
There are two methods of ending the algorithm:
1. **Finding a correct solutions**, where no queen can collide with other.

2. **Evaluating 10.000** times the fitness. 

</div>
## Running local

1. First you need to have [npm](https://www.npmjs.com) installed.
2. Install browser-sync using `npm install -g browser-sync`
3. On the project folder run: `browser-sync start --server -f .`

or you can [Running a local server](https://github.com/processing/p5.js/wiki/Local-server)
